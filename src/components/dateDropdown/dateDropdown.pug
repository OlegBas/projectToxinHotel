include ../calendar/calendar


mixin dateDropdown(options)
  //С помощью операции деструктуризации определим переменные на основе параметра options
  - var {start, end, startLabel= "Прибытие", endLabel= "Выезд", label= "Даты пребывания в отеле", split = false} = options
  - var monthes = ["янв", "фев", "мар", "апр", "май", "июн", "июл", "авг", "сен", "окт", "ноя", "дек"]

  //Если при вызове блока dateDropdown переданы две даты (start и end), чтобы можно задать  начальную и конечную дату, то
  if start && end
    // Если число дня меньше 10, то добавляем ведущий ноль, иначе оставляем без изменений
    - var startDD = start.getDate() < 10 ? `0${start.getDate()}` : start.getDate()
    // Если число месяца меньше 10, то добавляем ведущий ноль, иначе оставляем без изменений
    //1 месяц это - 0, поэтому getMonth() + 1
    - var startMM = start.getMonth() + 1 < 10 ? `0${start.getMonth() + 1}` : start.getMonth() + 1
    - var startYYYY = start.getFullYear()
    // Формируем строку даты в формете дд.мм.гггг
    - var startDateString = `${startDD}.${startMM}.${startYYYY}`

    //То же делаем с конечной датой
    - var endDD = end.getDate() < 10 ? `0${end.getDate()}` : end.getDate()
    - var endMM = end.getMonth() + 1 < 10 ? `0${end.getMonth() + 1}` : end.getMonth() + 1
    - var endYYYY = end.getFullYear()
    - var endDateString = `${endDD}.${endMM}.${endYYYY}`

    - var periodDateString = `${start.getDate()} ${monthes[start.getMonth()]} – ${end.getDate()} ${monthes[end.getMonth()]}`

  -
    //Формируем массив объектов для блока input. Если split (вывод двух полей для выбора даты)
    var inputsData = split
      ? [{label: startLabel, value: startDateString}, {label: endLabel, value: endDateString}]
      : [{label: label, value: periodDateString}]
  script(src='./assets/js/func.js')
  .dateDropdown.jsDateDropdown
    //Выводи элементы для выбора дат из массива объектов
    for inputDataItem, index in inputsData
      //Добавляем класс dateDropdown__item--gap-m только первому элементу
      //Вычисляем последний элемент index === inputsData.length - 1
      //Т.к нумерация элементов в массиве с 0, то inputsData.length - 1


      .dateDropdown__item(class= (index === inputsData.length - 1) ? "" : "dateDropdown__item_pad")
        label.dateDropdown__wrapper
          .dateDropdown__label= inputDataItem.label
          .dateDropdown__input-wrapper
            button.dateDropdown__button(type="button")
              i.material-icons expand_more
            input.dateDropdown__input.dateDropdown__input_with-icon(value=inputDataItem.value placeholder="ДД.ММ.ГГГГ" name="arrival" required)
            //- click-area для работы js, тк если input disabled не срабатывает событие клика на inputs-wrapper 
            .dateDropdown__click-area
    //Выводим календарь
    .dateDropdown__datepicker
      +calendar()